<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>Events</title>
		<link rel="stylesheet" href="dependencies/reset.css">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sakura.css/css/sakura.css" type="text/css">
		<link rel="stylesheet" href="dependencies/chota-grid.css">
		<link rel="stylesheet" href="styles/style.css">
		<!--<link rel="icon" href="favicon.ico" type="image/x-icon">-->
	</head>
	<body>
		<div id="app">
			<main>
				<h1>Events</h1>
				<form>
					<div class="row">
						<div class="col">
							<label for="title">Title</label>
		  					<input type="text" id="title" name="title" v-model="title" placeholder="My Event">
						</div>
					</div>
					<div class="row">
						<div class="col">
							<label for="location">Location</label>
		  					<input type="text" id="location" name="location" v-model="location" placeholder="Location TBA">
						</div>
						<div class="col">
							<label for="start-datetime">Start</label>
		  					<input type="datetime-local" id="start-datetime" name="start-datetime" v-model="startDatetime" placeholder="2026-01-01">
						</div>
						<div class="col">
							<label for="end-datetime">End</label>
		  					<input type="datetime-local" id="end-datetime" name="end-datetime" v-model="endDatetime" placeholder="2026-01-01">
						</div>
					</div>
					<div class="row">
						<div class="col">
							<label for="rsvp">RSVP</label>
	  						<input type="text" id="rsvp" name="rsvp" v-model="rsvp" placeholder="eventorganiser@example.com">
						</div>
						<div class="col">
							<label for="rsvp-date">RSVP Date</label>
	  						<input type="date" id="rsvp-date" name="rsvp-date" v-model="rsvpDate" placeholder="2026-01-01">
						</div>
					</div>
					<div class="row">
						<div class="col">
							<label for="image-url">Image URL</label>
	  						<input type="url" id="image-url" name="image-url" v-model="imageUrl" placeholder="https://example.com/event-poster.png">
						</div>
						<div class="col">
							<label for="theme">Theme</label>
	  						<input type="text" id="theme" name="theme" v-model="theme" placeholder="party">
						</div>
						<div class="col">
							<label for="rng">RNG</label>
	  						<input type="number" min="0" max="999" step="1" id="rng" name="rng" v-model="rng">
						</div>
					</div>
					<div class="row">
						<div class="col">
							<label for="description">Description</label>
	  						<textarea id="description" name="description" v-model="description" placeholder="Description here"></textarea>
						</div>
					</div>
				</form>
				<p v-text="eventString">Sample text</p>
				<p v-text="eventStringEncoded">Sample text</p>
				<p v-text="eventStringCompressedEncoded">Sample text</p>
			</main>
		</div>
		<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
		<script src="https://unpkg.com/vue-async-computed@4.0.1"></script>
		<script src="dependencies/UniBinary.js"></script>
		<script src="dependencies/compress.js"></script>
		<script src="scripts/index.js"></script>
		<script>
			const app = Vue.createApp({
				data() {
					return {
						title: "",
						location: "",
						startDatetime: "",
						endDatetime: "",
						rsvp: "",
						rsvpDate: "",
						theme: "",
						rng: this.randomInt(0,999),
						imageUrl: "",
						description: ""
					};
				},
				methods: {
					encode(str) {
						return unibinary.encodeString(str);
					},
					async compressAndEncode(str) {
						return await unibinary.encode(await compress(str));
					},
					decode(str) {
						try {
							return unibinary.decodeString(str);
						} catch {
							return 'invalid link';
						}
					},
					async decodeAndDecompress(str) {
						try {
							return await decompress(unibinary.decode(str));
						} catch {
							return 'invalid link';
						}
					},
					randomInt(min, max) { // returns a number inclusive of min and max
						return Math.floor(Math.random() * (max + 1 - min) + min);
					}
				},
				computed: {
					eventString() {
						return this.title + "`" +
							this.location + "`" +
							this.startDatetime + "`" +
							this.endDatetime + "`" +
							this.rsvp + "`" +
							this.rsvpDate + "`" +
							this.theme + "`" +
							(this.theme ? this.rng : "") + "`" +
							this.imageUrl + "`" +
							this.description;
					},
					eventStringEncoded() { return this.encode(this.eventString); }
				},
				asyncComputed: {
					async eventStringCompressedEncoded() { return await this.compressAndEncode(this.eventString); }
				}
			});
			app.use(AsyncComputed)
			app.mount('#app');
		</script>
	</body>
</html>
